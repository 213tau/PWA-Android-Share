<script>
async function loadSharedFiles() {
  return new Promise((resolve) => {
    const dbReq = indexedDB.open("shared-files", 1);
    dbReq.onsuccess = () => {
      const tx = dbReq.result.transaction("files", "readonly");
      const store = tx.objectStore("files");
      const getAll = store.getAll();
      getAll.onsuccess = () => resolve(getAll.result);
    };
  });
}

loadSharedFiles().then(files => {
  files.forEach(file => {
    const url = URL.createObjectURL(file);
    document.body.innerHTML += `<p>${file.name}</p>`;
    if (file.type.startsWith("image/")) {
      document.body.innerHTML += `<img src="${url}" width="200">`;
    }
  });
});
</script>
